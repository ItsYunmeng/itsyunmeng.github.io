<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Neo Sans Intel:300,300italic,400,400italic,700,700italic|Times New Roman:300,300italic,400,400italic,700,700italic|Lato:300,300italic,400,400italic,700,700italic|Helvetica:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"itsyunmeng.github.io","root":"/","scheme":"Pisces","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="摘要： 物种和环境数据的探索性分析，包含生物多样性指数、物种数据转化、环境变量之间的关系、环境因子标准化和正态性检验等。">
<meta property="og:type" content="article">
<meta property="og:title" content="笔记_数量生态学_2.探索性数据分析">
<meta property="og:url" content="https://itsyunmeng.github.io/2020/04/20/NumericalEcologywithR-2-exploratorydataanalysis/index.html">
<meta property="og:site_name" content="Yunmeng&#39;s Blog">
<meta property="og:description" content="摘要： 物种和环境数据的探索性分析，包含生物多样性指数、物种数据转化、环境变量之间的关系、环境因子标准化和正态性检验等。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/1.SpeAbundanceBarplot.png">
<meta property="og:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/2.SiteLocations.png">
<meta property="og:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/3.AbundanceDistribution.png">
<meta property="og:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/4.speoccurrencesandrelative%20frequencies.png">
<meta property="og:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/5.sperichnessinsite.png">
<meta property="og:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/6.datatransformation.png">
<meta property="og:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/7.abundancestandarizationplot.png">
<meta property="og:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/8.envbubblechart.png">
<meta property="og:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/9.envdistribution.das.png">
<meta property="og:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/10.envbivariateplots.png">
<meta property="og:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/11.rawandlogtransformation.png">
<meta property="article:published_time" content="2020-04-20T11:59:26.000Z">
<meta property="article:modified_time" content="2020-04-21T07:01:59.352Z">
<meta property="article:author" content="Yunmeng">
<meta property="article:tag" content="R.Books">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/1.SpeAbundanceBarplot.png">

<link rel="canonical" href="https://itsyunmeng.github.io/2020/04/20/NumericalEcologywithR-2-exploratorydataanalysis/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>笔记_数量生态学_2.探索性数据分析 | Yunmeng's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Yunmeng's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="https://itsyunmeng.github.io/2020/04/20/NumericalEcologywithR-2-exploratorydataanalysis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Yunmeng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yunmeng's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          笔记_数量生态学_2.探索性数据分析
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-20 13:59:26" itemprop="dateCreated datePublished" datetime="2020-04-20T13:59:26+02:00">2020-04-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-21 09:01:59" itemprop="dateModified" datetime="2020-04-21T09:01:59+02:00">2020-04-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>摘要：</strong> 物种和环境数据的探索性分析，包含生物多样性指数、物种数据转化、环境变量之间的关系、环境因子标准化和正态性检验等。</p>
<a id="more"></a>
<h1 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h1><p>探索性数据分析（exploratory data analysis, EDA），目的在于：</p>
<ul>
<li>了解数据概况</li>
<li>对某些变量进行转化或重新编码</li>
<li>确定下一步分析的方向</li>
</ul>
<h1 id="数据探索"><a href="#数据探索" class="headerlink" title="数据探索"></a>数据探索</h1><h2 id="数据提取"><a href="#数据提取" class="headerlink" title="数据提取"></a>数据提取</h2><p>导入数据</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spe&lt;-<span class="built_in">read</span>.csv(<span class="string">"DoubsSpe.csv"</span>,head=T,<span class="built_in">row</span>.names=<span class="number">1</span>)</span><br><span class="line">spa&lt;-<span class="built_in">read</span>.csv(<span class="string">"DoubsSpa.csv"</span>,head=T,<span class="built_in">row</span>.names=<span class="number">1</span>)</span><br><span class="line">env&lt;-<span class="built_in">read</span>.csv(<span class="string">"DoubsEnv.csv"</span>,head=T,<span class="built_in">row</span>.names=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h2 id="物种数据：第一次接触"><a href="#物种数据：第一次接触" class="headerlink" title="物种数据：第一次接触"></a>物种数据：第一次接触</h2><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">spe[<span class="number">1</span>:<span class="number">5</span>,<span class="number">1</span>:<span class="number">10</span>]</span><br><span class="line">head(spe)</span><br><span class="line">nrow(spe)</span><br><span class="line">ncol(spe)</span><br><span class="line">dim(spe)</span><br><span class="line">rownames(spe)</span><br><span class="line">colnames(spe)</span><br><span class="line">summary(spe) #以列为单位，对列变量进行描述性统计。比较中位数和平均值，大部分物种多度的分布是对称的嘛？</span><br><span class="line">range(spe) #整个多度数据值的范围</span><br><span class="line">ab&lt;-table(unlist(spe)) #✨计算每种多度值的数目</span><br><span class="line">ab</span><br><span class="line">barplot(ab,las=<span class="number">1</span>,xlab=<span class="string">"Abundance class"</span>,ylab=<span class="string">"Frequency"</span>,col=gray(<span class="number">5</span>:<span class="number">0</span>/<span class="number">5</span>))</span><br><span class="line">#las表示横纵坐标数值的方向，可以<span class="number">0</span>、<span class="number">1</span>、<span class="number">2</span>、<span class="number">3</span>都试一下。col=gray(<span class="number">5</span>:<span class="number">0</span>/<span class="number">5</span>)，<span class="number">5</span>:<span class="number">0</span>产生<span class="number">5</span>、<span class="number">4</span>、<span class="number">3</span>、<span class="number">2</span>、<span class="number">1</span>、<span class="number">0</span>，/<span class="number">100</span>是分别对<span class="number">5</span>、<span class="number">4</span>、、、<span class="number">0</span>这<span class="number">6</span>个数的向量进行除法运算，故<span class="number">5</span>:<span class="number">0</span>/<span class="number">5</span>产生<span class="number">1</span>、<span class="number">0.8</span>、<span class="number">0.6</span>、<span class="number">0.4</span>、<span class="number">0.2</span>和<span class="number">0</span>这<span class="number">6</span>个数的向量，这<span class="number">6</span>个向量带入到gray函数的参数中返回的是由白到黑均匀变化的<span class="number">6</span>种颜色。</span><br><span class="line">sum(spe==<span class="number">0</span>) #多度数据中<span class="number">0</span>值（缺失）的数量</span><br><span class="line">sum(spe==<span class="number">0</span>)/(nrow(spe)*ncol(spe)) #多度数据中<span class="number">0</span>值所占的比例</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/1.SpeAbundanceBarplot.png" alt="1.SpeAbundanceBarplot"></p>
<h2 id="物种数据：进一步分析"><a href="#物种数据：进一步分析" class="headerlink" title="物种数据：进一步分析"></a>物种数据：进一步分析</h2><h3 id="样方位置分布图，借助spa文件（地理坐标x和y）"><a href="#样方位置分布图，借助spa文件（地理坐标x和y）" class="headerlink" title="样方位置分布图，借助spa文件（地理坐标x和y）"></a>样方位置分布图，借助spa文件（地理坐标x和y）</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">plot</span><span class="params">(spa,asp=<span class="number">1</span>,type=<span class="string">"n"</span>,main=<span class="string">"Site Locations"</span>,xlab=<span class="string">"x coordinate (km)"</span>,ylab=<span class="string">"y coordinate (km)"</span>)</span></span></span><br><span class="line">#asp=<span class="number">1</span>表示纵横比；type=<span class="string">"n"</span>表示空，<span class="string">"p"</span>表示点，<span class="string">"l"</span>表示线等。</span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(spa,col=<span class="string">"lightblue"</span>)</span></span></span><br><span class="line">#添加图层---线，代表doubs河</span><br><span class="line"><span class="function"><span class="title">text</span><span class="params">(spa,row.names(spa)</span></span>,cex=<span class="number">0.8</span>,col=<span class="string">"red"</span>,pos=<span class="number">4</span>)</span><br><span class="line">#添加每个样方的编号，cex=<span class="number">0.8</span>表示数据点标识的大小，默认为<span class="number">1</span>，pos=<span class="number">4</span>表示编号的位置，<span class="number">4</span>表示在点右边。</span><br><span class="line"><span class="function"><span class="title">text</span><span class="params">(<span class="number">60</span>,<span class="number">10</span>,<span class="string">"Upstream"</span>,cex=<span class="number">0.8</span>,col=<span class="string">"red"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">text</span><span class="params">(<span class="number">0</span>,<span class="number">120</span>,<span class="string">"Downstream"</span>,cex=<span class="number">0.8</span>,col=<span class="string">"red"</span>)</span></span></span><br><span class="line">#添加文本</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/2.SiteLocations.png" alt="2.SiteLocations"></p>
<h3 id="鱼类的分布图，借助spe文件（多度）"><a href="#鱼类的分布图，借助spe文件（多度）" class="headerlink" title="鱼类的分布图，借助spe文件（多度）"></a>鱼类的分布图，借助spe文件（多度）</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">par</span><span class="params">(mfrow=c(<span class="number">2</span>,<span class="number">2</span>)</span></span>) #将绘图窗口分割为<span class="number">4</span>个绘图区域，每行两个。</span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(spa,asp=<span class="number">1</span>,col=<span class="string">"brown"</span>,cex=spe<span class="variable">$TRU</span>,main=<span class="string">"Brown trout"</span>,xlab=<span class="string">"x coordinate (km)"</span>,ylab=<span class="string">"y coordinate (km)"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(spa,col=<span class="string">"lightblue"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(spa,asp=<span class="number">1</span>,col=<span class="string">"brown"</span>,cex=spe<span class="variable">$OMB</span>,main=<span class="string">"Grayling"</span>,xlab=<span class="string">"x coordinate (km)"</span>,ylab=<span class="string">"y coordinate (km)"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(spa,col=<span class="string">"lightblue"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(spa,asp=<span class="number">1</span>,col=<span class="string">"brown"</span>,cex=spe<span class="variable">$BAR</span>,main=<span class="string">"Barbel"</span>,xlab=<span class="string">"x coordinate (km)"</span>,ylab=<span class="string">"y coordinate (km)"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(spa,col=<span class="string">"lightblue"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(spa,asp=<span class="number">1</span>,col=<span class="string">"brown"</span>,cex=spe<span class="variable">$BCO</span>,main=<span class="string">"Common bream"</span>,xlab=<span class="string">"x coordinate (km)"</span>,ylab=<span class="string">"y coordinate (km)"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(spa,col=<span class="string">"lightblue"</span>)</span></span></span><br><span class="line">#cex的作用是定义数据点标识的大小，这里用某物种的多度数据来表示大小。</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/3.AbundanceDistribution.png" alt="3.AbundanceDistribution"></p>
<h3 id="物种相对频度直方图"><a href="#物种相对频度直方图" class="headerlink" title="物种相对频度直方图"></a>物种相对频度直方图</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line">spe.pres&lt;-apply(spe&gt;<span class="number">0</span>,<span class="number">2</span>,sum)</span><br><span class="line">#计算每个物种出现的样方数。apply函数，spe&gt;<span class="number">0</span>表示先将spe内数值转化为逻辑向量<span class="literal">TRUE</span>/FLASE，然后对逻辑值<span class="literal">TRUE</span>进行列(<span class="number">1</span>表示行，<span class="number">2</span>表示列)的计数汇总(sum)。</span><br><span class="line">sort(spe.pres)</span><br><span class="line">#按照升序的方式重新排列结果。sort，默认的是升序。</span><br><span class="line">hist(spe.pres,las=<span class="number">1</span>,col=<span class="string">"bisque"</span>,main=<span class="string">"Species Occurrences"</span>,xlab=<span class="string">"Number of occurrences"</span>,ylab=<span class="string">"Number of species"</span>,breaks=seq(<span class="number">0</span>,<span class="number">30</span>,by=<span class="number">5</span>),right=<span class="literal">FALSE</span>)</span><br><span class="line">#breaks=seq(<span class="number">0</span>,<span class="number">30</span>,by=<span class="number">5</span>)表示设置分组，<span class="number">0</span>到<span class="number">30</span>，间隔为<span class="number">5</span>，设置成<span class="number">0</span><span class="number">-30</span>其实也是因为总共采了<span class="number">30</span>个样方，比较好表示。right=<span class="literal">FALSE</span>表示[)，即左边的数值包括在内右边的不包含在内。</span><br><span class="line">spe.relf&lt;<span class="number">-100</span>*spe.pres/nrow(spe)</span><br><span class="line">#计算频度百分比</span><br><span class="line">round(sort(spe.relf),<span class="number">1</span>)</span><br><span class="line">#设置排列结果为<span class="number">1</span>位小数。round设置数据显示的小数位数。</span><br><span class="line">hist(spe.relf,las=<span class="number">1</span>,col=<span class="string">"bisque"</span>,main=<span class="string">"Species Relative Fequencies"</span>,xlab=<span class="string">"Frequencies of occurrences"</span>,ylab=<span class="string">"Number of species"</span>,breaks=seq(<span class="number">0</span>,<span class="number">100</span>,by=<span class="number">10</span>),right=<span class="literal">FALSE</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/4.speoccurrencesandrelative%20frequencies.png" alt="4.speoccurrencesandrelative frequencies"></p>
<h3 id="样方中物种丰富度分布图"><a href="#样方中物种丰富度分布图" class="headerlink" title="样方中物种丰富度分布图"></a>样方中物种丰富度分布图</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">par</span><span class="params">(mfrow=c(<span class="number">1</span>,<span class="number">2</span>)</span></span>)</span><br><span class="line">sit.pres&lt;-apply(spe&gt;<span class="number">0</span>,<span class="number">1</span>,sum)</span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(sit.pres,type=<span class="string">"s"</span>,main=<span class="string">"Species Richness vs. \n Upstream-Downstream Gradient"</span>,las=<span class="number">1</span>,xlab=<span class="string">"Positions of sites along the river"</span>,ylab=<span class="string">"Species richness"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">text</span><span class="params">(sit.pres,row.names(spe)</span></span>,cex=<span class="number">0.8</span>,col=<span class="string">"black"</span>,pos=<span class="number">2</span>)</span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(spa,asp=<span class="number">1</span>,pch=<span class="number">21</span>,col=<span class="string">"black"</span>,bg=<span class="string">"bisque"</span>,cex=<span class="number">4</span>*sit.pres/max(sit.pres)</span></span>,main=<span class="string">"Map of Species Richness"</span>,xlab=<span class="string">"x coordinate (km)"</span>,ylab=<span class="string">"y coordinate (km)"</span>)#pch，圆形，col，圆形边界颜色；bg，圆形填充颜色；cex用物种丰富度表示大小，太大时，可等比例缩小，比如乘以<span class="number">0.1</span>等。</span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(spa,col=<span class="string">"black"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">text</span><span class="params">(spa,row.names(spa)</span></span>,col=<span class="string">"black"</span>,pos=<span class="number">3</span>,cex=<span class="number">0.8</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/5.sperichnessinsite.png" alt="5.sperichnessinsite"></p>
<h3 id="生物多样性指数"><a href="#生物多样性指数" class="headerlink" title="生物多样性指数"></a>生物多样性指数</h3><p>多度是指种群中个体的数目。<br>丰富度是指群落中物种的数目。</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">library(vegan)</span><br><span class="line">#物种丰富度(richness)</span><br><span class="line">richness&lt;-rowSums(spe&gt;<span class="number">0</span>) #或richness&lt;-apply(spe&gt;<span class="number">0</span>,<span class="number">1</span>,sum)或richness&lt;-estimateR(spe)[<span class="number">1</span>,]</span><br><span class="line">#香农指数（Shannon index）(以下shannon公式的对数底数均设使用 e，在 R 中即表示为 exp(<span class="number">1</span>))</span><br><span class="line">shannon_index&lt;-diversity(spe,index=<span class="string">"shannon"</span>,base=exp(<span class="number">1</span>))#✨shannon指数或shannon熵指数  </span><br><span class="line">shannon_diversity&lt;-exp(<span class="number">1</span>)^(shannon_index)#shannon多样性指数</span><br><span class="line">#辛普森指数(simpson index)</span><br><span class="line">gini_simpson_index&lt;-diversity(spe,<span class="string">"simpson"</span>)#✨Gini-Simpson指数,即我们平常用的simpson指数。与丰富度成正比。</span><br><span class="line">simpson_index&lt;-<span class="number">1</span>-gini_simpson_index#经典simpson指数，使用频率比较低</span><br><span class="line">invsimpson_index&lt;-<span class="number">1</span>/gini_simpson_index#invsimpson指数（Gini-Simpson指数的倒数）#或invsimpson_index&lt;-diversity(spe,<span class="string">"invsimpson"</span>)</span><br><span class="line">simpson_diversity&lt;-<span class="number">1</span>/(<span class="number">1</span>-gini_simpson_index)#simpson多样性</span><br><span class="line">#均匀度（Evenness）</span><br><span class="line">pielou&lt;-shannon_index/log(richness,exp(<span class="number">1</span>))#✨Shannon均匀度，即pielou均匀度（Hill比率）</span><br><span class="line">equitability&lt;-<span class="number">1</span>/(richness*(<span class="number">1</span>-gini_simpson_index))#simpson均匀度，即equitability均匀度（Hill比率）</span><br><span class="line">#Chao1 &amp; ACE</span><br><span class="line">chao1&lt;-estimateR(spe)[<span class="number">2</span>,] #?estimateR</span><br><span class="line">ace&lt;-estimateR(spe)[<span class="number">4</span>,]</span><br><span class="line">#goods_coverage指数</span><br><span class="line">goods_coverage&lt;-<span class="number">1</span>-rowSums(spe==<span class="number">1</span>)/rowSums(spe)</span><br><span class="line">#谱系多样性（与上述相比，还需指定进化树文件；除了物种丰度外，还考虑了进化距离。）</span><br><span class="line">library(picante)</span><br><span class="line">tree&lt;-read.tree(<span class="string">'otu_tree.tre'</span>)#otu_tree.tre，无根树文件</span><br><span class="line">pd_whole_tree&lt;-pd(otu,tree,include.root=FALSE)#测试时发现有根树和无根树的 PD_whole_tree 计算结果是一样的，但是无根树的计算会更快</span><br><span class="line">#整合数据</span><br><span class="line">div&lt;-data.frame(richness,shannon_index,shannon_diversity,pielou,gini_simpson_index,simpson_index,invsimpson_index,simpson_diversity,equitability,chao1,ace,goods_coverage,#pd_whole_tree)</span><br><span class="line">#保存</span><br><span class="line">write.csv(div, <span class="string">'alphadiversity.csv'</span>, quote = FALSE)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><a href="http://blog.sciencenet.cn/blog-3406804-1179809.html" target="_blank" rel="noopener">群落多样性分子中常见Alpha多样性指数简介</a><br><a href="http://blog.sciencenet.cn/blog-3406804-1179983.html" target="_blank" rel="noopener">R语言计算Alpha多样性指数</a></p>
</blockquote>
<h2 id="物种数据转化"><a href="#物种数据转化" class="headerlink" title="物种数据转化"></a>物种数据转化</h2><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">##简单转化  </span><br><span class="line">sqrt()#平方根</span><br><span class="line">sqrt(sqrt())#四次方根</span><br><span class="line">log1p()#多度+<span class="number">1</span>的自然对数，保证<span class="number">0</span>值转化后仍然为<span class="number">0</span>。</span><br><span class="line"></span><br><span class="line">#物种水平：两种方法；有-无数据或多度数据</span><br><span class="line">spe.scal&lt;-decostand(spe,<span class="string">"max"</span>)#通过每个数值除以该物种最大值标准化多度，默认MARGIN为<span class="number">2</span>，即列。</span><br><span class="line">spe.relsp&lt;-decostand(spe,<span class="string">"total"</span>,<span class="number">2</span>)#通过每个数值除以该物种总和去标准化多度（每个物种的相对多度）</span><br><span class="line"></span><br><span class="line">#样方水平：三种方法；有-无数据或多度数据</span><br><span class="line">spe.rel&lt;-decostand(spe,<span class="string">"total"</span>,<span class="number">1</span>)#通过每个数值除以该样方总和标准化多度（每个样方的相对多度）</span><br><span class="line">spe.nrom&lt;-decostand(spe,<span class="string">"normalize"</span>)#“弦转化”，即赋予每个行向量长度（范数）为<span class="number">1</span>，即平方和为<span class="number">1.</span></span><br><span class="line">spe.hel&lt;-decostand(spe,<span class="string">"hellinger"</span>)#<span class="string">"Hellinger"</span>转化，即计算相对频度（样方层面），然后取平方根。<span class="string">"Hellinger"</span>转化等同于数据先平方根转化再进行弦转化。</span><br><span class="line"></span><br><span class="line">#物种和样方同时标准化</span><br><span class="line">spe.chi&lt;-decostand(spe,<span class="string">"chi.square"</span>)#卡方转化</span><br><span class="line">spe.wis&lt;-wisconsin(spe)#Wisconsin标准化,即多度数据首先除以该物种最大值后再除以该样方总和。</span><br></pre></td></tr></table></figure>
<h3 id="标准化后的数据比较和作图"><a href="#标准化后的数据比较和作图" class="headerlink" title="标准化后的数据比较和作图"></a>标准化后的数据比较和作图</h3><h4 id="鱼LOC的多度数据转化前后箱线图"><a href="#鱼LOC的多度数据转化前后箱线图" class="headerlink" title="鱼LOC的多度数据转化前后箱线图"></a>鱼LOC的多度数据转化前后箱线图</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">par</span><span class="params">(mfrow=c(<span class="number">2</span>,<span class="number">2</span>)</span></span>)</span><br><span class="line"><span class="function"><span class="title">boxplot</span><span class="params">(spe<span class="variable">$LOC</span>,sqrt(spe<span class="variable">$LOC</span>)</span></span>,log1p(spe<span class="variable">$LOC</span>),las=<span class="number">1</span>,main=<span class="string">"Simple transformation"</span>,names=c(<span class="string">"raw data"</span>,<span class="string">"sqrt"</span>,<span class="string">"log"</span>),col=<span class="string">"bisque"</span>)</span><br><span class="line"><span class="function"><span class="title">boxplot</span><span class="params">(spe.scal<span class="variable">$LOC</span>,spe.relsp<span class="variable">$LOC</span>,las=<span class="number">1</span>,main=<span class="string">"Standardization by species"</span>,names=c(<span class="string">"max"</span>,<span class="string">"total"</span>)</span></span>,col=<span class="string">"lightgreen"</span>)</span><br><span class="line"><span class="function"><span class="title">boxplot</span><span class="params">(spe.hel<span class="variable">$LOC</span>,spe.rel<span class="variable">$LOC</span>,spe.nrom<span class="variable">$LOC</span>,las=<span class="number">1</span>,main=<span class="string">"Standardization by sites"</span>,names=c(<span class="string">"Hellinger"</span>,<span class="string">"total"</span>,<span class="string">"nrom"</span>)</span></span>,col=<span class="string">"lightblue"</span>)</span><br><span class="line"><span class="function"><span class="title">boxplot</span><span class="params">(spe.chi<span class="variable">$LOC</span>,spe.wis<span class="variable">$LOC</span>,las=<span class="number">1</span>,main=<span class="string">"Double standardization"</span>,names=c(<span class="string">"Chi-square"</span>,<span class="string">"Wisconsin"</span>)</span></span>,col=<span class="string">"orange"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/6.datatransformation.png" alt="6"></p>
<h4 id="物种-多度原始数据及其标准化数据-从河流上游到下游（das）的分布图"><a href="#物种-多度原始数据及其标准化数据-从河流上游到下游（das）的分布图" class="headerlink" title="物种(多度原始数据及其标准化数据)从河流上游到下游（das）的分布图"></a>物种(多度原始数据及其标准化数据)从河流上游到下游（das）的分布图</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">par</span><span class="params">(mfrow=c(<span class="number">2</span>,<span class="number">2</span>)</span></span>)</span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(env<span class="variable">$das</span>,spe<span class="variable">$TRU</span>,type=<span class="string">"l"</span>,col=<span class="number">4</span>,main=<span class="string">"Raw Data"</span>,xlab=<span class="string">"Distance from the source (km)"</span>,ylab=<span class="string">"Raw abundance code"</span>)</span></span></span><br><span class="line">#原始数据</span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe<span class="variable">$OMB</span>,col=<span class="number">3</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe<span class="variable">$BAR</span>,col=<span class="string">"orange"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe<span class="variable">$BCO</span>,col=<span class="number">2</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe<span class="variable">$LOC</span>,col=<span class="number">1</span>,lty=<span class="string">"dotted"</span>)</span></span></span><br><span class="line">#物种水平“max”转化</span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(env<span class="variable">$das</span>,spe.scal<span class="variable">$TRU</span>,type=<span class="string">"l"</span>,col=<span class="number">4</span>,main=<span class="string">"Species profiles (max)"</span>,xlab=<span class="string">"Distance from the source (km)"</span>,ylab=<span class="string">"Standardized abundance"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.scal<span class="variable">$OMB</span>,col=<span class="number">3</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.scal<span class="variable">$BAR</span>,col=<span class="string">"orange"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.scal<span class="variable">$BCO</span>,col=<span class="number">2</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.scal<span class="variable">$LOC</span>,col=<span class="number">1</span>,lty=<span class="string">"dotted"</span>)</span></span></span><br><span class="line">#样方水平“Hellinger”转化</span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(env<span class="variable">$das</span>,spe.hel<span class="variable">$TRU</span>,type=<span class="string">"l"</span>,col=<span class="number">4</span>,main=<span class="string">"Species profiles (Hellinger)"</span>,xlab=<span class="string">"Distance from the source (km)"</span>,ylab=<span class="string">"Standardized abundance"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.hel<span class="variable">$OMB</span>,col=<span class="number">3</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.hel<span class="variable">$BAR</span>,col=<span class="string">"orange"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.hel<span class="variable">$BCO</span>,col=<span class="number">2</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.hel<span class="variable">$LOC</span>,col=<span class="number">1</span>,lty=<span class="string">"dotted"</span>)</span></span></span><br><span class="line">#物种和样方同时转化“Chi-square”</span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(env<span class="variable">$das</span>,spe.chi<span class="variable">$TRU</span>,type=<span class="string">"l"</span>,col=<span class="number">4</span>,main=<span class="string">"Species profiles (Chi-square)"</span>,xlab=<span class="string">"Distance from the source (km)"</span>,ylab=<span class="string">"Standardized abundance"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.chi<span class="variable">$OMB</span>,col=<span class="number">3</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.chi<span class="variable">$BAR</span>,col=<span class="string">"orange"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.chi<span class="variable">$BCO</span>,col=<span class="number">2</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(env<span class="variable">$das</span>,spe.chi<span class="variable">$LOC</span>,col=<span class="number">1</span>,lty=<span class="string">"dotted"</span>)</span></span></span><br><span class="line">#添加图例</span><br><span class="line"><span class="function"><span class="title">legend</span><span class="params">(<span class="string">"topright"</span>,c(<span class="string">"Brown trout"</span>,<span class="string">"Grayling"</span>,<span class="string">"Barbel"</span>,<span class="string">"Common bream"</span>,<span class="string">"Stone loach"</span>)</span></span>,col=c(<span class="number">4</span>,<span class="number">3</span>,<span class="string">"orange"</span>,<span class="number">2</span>,<span class="number">1</span>),lty=c(rep(<span class="number">1</span>,<span class="number">4</span>),<span class="number">3</span>),cex=<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/7.abundancestandarizationplot.png" alt="7"></p>
<h2 id="环境数据"><a href="#环境数据" class="headerlink" title="环境数据"></a>环境数据</h2><h3 id="环境数据（海拔、流量、氧含量和硝酸盐浓度）的气泡地图"><a href="#环境数据（海拔、流量、氧含量和硝酸盐浓度）的气泡地图" class="headerlink" title="环境数据（海拔、流量、氧含量和硝酸盐浓度）的气泡地图"></a>环境数据（海拔、流量、氧含量和硝酸盐浓度）的气泡地图</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">par</span><span class="params">(mfrow=c(<span class="number">2</span>,<span class="number">2</span>)</span></span>)</span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(spa,asp=<span class="number">1</span>,main=<span class="string">"Altitude"</span>,pch=<span class="number">21</span>,col=<span class="string">"white"</span>,bg=<span class="string">"red"</span>,cex=<span class="number">5</span>*env<span class="variable">$alt</span>/max(env<span class="variable">$alt</span>)</span></span>,xlab=<span class="string">"x"</span>,ylab=<span class="string">"y"</span>)</span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(spa,col=<span class="string">"black"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(spa,asp=<span class="number">1</span>,main=<span class="string">"Discharge"</span>,pch=<span class="number">21</span>,col=<span class="string">"white"</span>,bg=<span class="string">"blue"</span>,cex=<span class="number">5</span>*env<span class="variable">$deb</span>/max(env<span class="variable">$deb</span>)</span></span>,xlab=<span class="string">"x"</span>,ylab=<span class="string">"y"</span>)</span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(spa,col=<span class="string">"black"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(spa,asp=<span class="number">1</span>,main=<span class="string">"Oxygen"</span>,pch=<span class="number">21</span>,col=<span class="string">"white"</span>,bg=<span class="string">"green3"</span>,cex=<span class="number">5</span>*env<span class="variable">$oxy</span>/max(env<span class="variable">$oxy</span>)</span></span>,xlab=<span class="string">"x"</span>,ylab=<span class="string">"y"</span>)</span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(spa,col=<span class="string">"black"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(spa,asp=<span class="number">1</span>,main=<span class="string">"Nitrate"</span>,pch=<span class="number">21</span>,col=<span class="string">"white"</span>,bg=<span class="string">"brown"</span>,cex=<span class="number">5</span>*env<span class="variable">$nit</span>/max(env<span class="variable">$nit</span>)</span></span>,xlab=<span class="string">"x"</span>,ylab=<span class="string">"y"</span>)</span><br><span class="line"><span class="function"><span class="title">lines</span><span class="params">(spa,col=<span class="string">"black"</span>)</span></span></span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/8.envbubblechart.png" alt="8"></p>
<h3 id="环境数据（海拔、流量、氧含量和硝酸盐浓度）沿河流的分布"><a href="#环境数据（海拔、流量、氧含量和硝酸盐浓度）沿河流的分布" class="headerlink" title="环境数据（海拔、流量、氧含量和硝酸盐浓度）沿河流的分布"></a>环境数据（海拔、流量、氧含量和硝酸盐浓度）沿河流的分布</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">par</span><span class="params">(mfrow=c(<span class="number">2</span>,<span class="number">2</span>)</span></span>)</span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(env<span class="variable">$das</span>,env<span class="variable">$alt</span>,type=<span class="string">"l"</span>,main=<span class="string">"Altitude"</span>,xlab=<span class="string">"Distance from the source (km)"</span>,ylab=<span class="string">"Altitude (m)"</span>,col=<span class="string">"red"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(env<span class="variable">$das</span>,env<span class="variable">$deb</span>,type=<span class="string">"l"</span>,main=<span class="string">"Discharge"</span>,xlab=<span class="string">"Distance from the source (km)"</span>,ylab=<span class="string">"Discharge (m3/s)"</span>,col=<span class="string">"blue"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(env<span class="variable">$das</span>,env<span class="variable">$oxy</span>,type=<span class="string">"l"</span>,main=<span class="string">"Oxygen"</span>,xlab=<span class="string">"Distance from the source (km)"</span>,ylab=<span class="string">"Oxygen (mg/L)"</span>,col=<span class="string">"green3"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">plot</span><span class="params">(env<span class="variable">$das</span>,env<span class="variable">$nit</span>,type=<span class="string">"l"</span>,main=<span class="string">"Nitrate"</span>,xlab=<span class="string">"Distance from the source (km)"</span>,ylab=<span class="string">"Nitrate (mg/L)"</span>,col=<span class="string">"brown"</span>)</span></span></span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/9.envdistribution.das.png" alt="9"></p>
<h3 id="带频度分布的柱状图和光滑拟合曲线的双变量散点图"><a href="#带频度分布的柱状图和光滑拟合曲线的双变量散点图" class="headerlink" title="带频度分布的柱状图和光滑拟合曲线的双变量散点图"></a>带频度分布的柱状图和光滑拟合曲线的双变量散点图</h3><p>了解任意两个变量之间的关系以及哪些变量符合正态分布,注意pairs()的使用</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span>(<span class="string">"panelutils.R"</span>) #自编的函数R脚本,带LOWESS平滑线的任意两个环境变量之间的散点图</span><br><span class="line">pairs(<span class="keyword">env</span>,<span class="keyword">panel</span>=<span class="keyword">panel</span>.smooth,diag.<span class="keyword">panel</span>=<span class="keyword">panel</span>.hist,main=<span class="string">"Bivariate Plots with Histograms and Smooth Curves"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/10.envbivariateplots.png" alt="10"></p>
<p>简单的转化（例如对数转化）可以改善某些变量的数据分布（转化后更接近正态分布）。<br>另外，由于变量之间的量纲不同，很多统计分析需要将其进行标准化（标准化后均值等于0，方差等于1），这种中心化和标准化后的变量值也被称为z-scores。<br>中心化和标准化:</p>
<ul>
<li>意义：数据中心化和标准化在回归分析中是取消由于量纲不同、自身变异或者数值相差较大所引起的误差。</li>
<li>原理：数据标准化：是指数值减去均值，再除以标准差； 数据中心化：是指变量减去它的均值。</li>
<li>目的：通过中心化和标准化处理，得到均值为0，标准差为1的服从标准正态分布的数据。</li>
</ul>
<p>下面用案例数据展示转化和标准化后的数据分布:</p>
<h3 id="pen对数转化前后频度分布柱状图和箱线图"><a href="#pen对数转化前后频度分布柱状图和箱线图" class="headerlink" title="pen对数转化前后频度分布柱状图和箱线图"></a>pen对数转化前后频度分布柱状图和箱线图</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">par</span><span class="params">(mfrow=c(<span class="number">2</span>,<span class="number">2</span>)</span></span>)</span><br><span class="line"><span class="function"><span class="title">hist</span><span class="params">(env<span class="variable">$pen</span>,col=<span class="string">"bisque"</span>,right=<span class="string">"F"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">hist</span><span class="params">(log(env<span class="variable">$pen</span>,exp(<span class="number">1</span>)</span></span>),col=<span class="string">"light blue"</span>,<span class="attribute">right</span>=<span class="string">"F"</span>,main=<span class="string">"Histogram of ln(env$pen)"</span>,xlab=<span class="string">"ln(env$pen)"</span>)</span><br><span class="line"><span class="function"><span class="title">boxplot</span><span class="params">(env<span class="variable">$pen</span>,col=<span class="string">"bisque"</span>,main=<span class="string">"Boxplot of env$pen"</span>,ylab=<span class="string">"env$pen"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">boxplot</span><span class="params">(log(env<span class="variable">$pen</span>,exp(<span class="number">1</span>)</span></span>),col=<span class="string">"light blue"</span>,main=<span class="string">"Boxplot of ln(env$pen)"</span>,ylab=<span class="string">"ln(env$pen)"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/ItsYunmeng/MyPostImages/raw/master/NumericalEcologywithR-2-exploratorydataanalysis/11.rawandlogtransformation.png" alt="11"></p>
<h3 id="环境因子标准化和正态性检验"><a href="#环境因子标准化和正态性检验" class="headerlink" title="环境因子标准化和正态性检验"></a>环境因子标准化和正态性检验</h3><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">env</span>.z&lt;-decostand(<span class="keyword">env</span>,<span class="string">"standardize"</span>)</span><br><span class="line">apply(<span class="keyword">env</span>.z,<span class="number">2</span>,mean)#若小数位不明显，可以用round()函数。均值为<span class="number">0</span></span><br><span class="line">apply(<span class="keyword">env</span>.z,<span class="number">2</span>,sd)#标准差为<span class="number">1</span></span><br><span class="line">#使用<span class="keyword">scale</span>()函数也可以运行相同的标准化(输出的是矩阵)：<span class="keyword">env</span>.z1&lt;-as.data.frame(<span class="keyword">scale</span>(<span class="keyword">env</span>)) 等同于<span class="keyword">env</span>.z。</span><br></pre></td></tr></table></figure>
<p>检验正态分布<br>通过R里的shapiro.test()函数，用<a href="https://www.jianshu.com/p/e202069489a6" target="_blank" rel="noopener">Shapiro-Wilk检验</a>可以检验向量的正态性。</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shapiro.test(<span class="keyword">env</span>.z$oxy)</span><br><span class="line">shapiro.test(<span class="keyword">log</span>(<span class="keyword">env</span>)$oxy)</span><br><span class="line">#✨p&gt;<span class="number">0.05</span>则符合正态分布</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/R-Books/" rel="tag"># R.Books</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/04/20/NumericalEcologywithR-1-introduction/" rel="prev" title="笔记_数量生态学_1.绪论">
      <i class="fa fa-chevron-left"></i> 笔记_数量生态学_1.绪论
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/04/20/NumericalEcologywithR-3-associationmeasuresandmatrix/" rel="next" title="笔记_数量生态学_3.关联测度与矩阵">
      笔记_数量生态学_3.关联测度与矩阵 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#目标"><span class="nav-number">1.</span> <span class="nav-text">目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数据探索"><span class="nav-number">2.</span> <span class="nav-text">数据探索</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据提取"><span class="nav-number">2.1.</span> <span class="nav-text">数据提取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#物种数据：第一次接触"><span class="nav-number">2.2.</span> <span class="nav-text">物种数据：第一次接触</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#物种数据：进一步分析"><span class="nav-number">2.3.</span> <span class="nav-text">物种数据：进一步分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#样方位置分布图，借助spa文件（地理坐标x和y）"><span class="nav-number">2.3.1.</span> <span class="nav-text">样方位置分布图，借助spa文件（地理坐标x和y）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#鱼类的分布图，借助spe文件（多度）"><span class="nav-number">2.3.2.</span> <span class="nav-text">鱼类的分布图，借助spe文件（多度）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#物种相对频度直方图"><span class="nav-number">2.3.3.</span> <span class="nav-text">物种相对频度直方图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#样方中物种丰富度分布图"><span class="nav-number">2.3.4.</span> <span class="nav-text">样方中物种丰富度分布图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#生物多样性指数"><span class="nav-number">2.3.5.</span> <span class="nav-text">生物多样性指数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#物种数据转化"><span class="nav-number">2.4.</span> <span class="nav-text">物种数据转化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#标准化后的数据比较和作图"><span class="nav-number">2.4.1.</span> <span class="nav-text">标准化后的数据比较和作图</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#鱼LOC的多度数据转化前后箱线图"><span class="nav-number">2.4.1.1.</span> <span class="nav-text">鱼LOC的多度数据转化前后箱线图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#物种-多度原始数据及其标准化数据-从河流上游到下游（das）的分布图"><span class="nav-number">2.4.1.2.</span> <span class="nav-text">物种(多度原始数据及其标准化数据)从河流上游到下游（das）的分布图</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#环境数据"><span class="nav-number">2.5.</span> <span class="nav-text">环境数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#环境数据（海拔、流量、氧含量和硝酸盐浓度）的气泡地图"><span class="nav-number">2.5.1.</span> <span class="nav-text">环境数据（海拔、流量、氧含量和硝酸盐浓度）的气泡地图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#环境数据（海拔、流量、氧含量和硝酸盐浓度）沿河流的分布"><span class="nav-number">2.5.2.</span> <span class="nav-text">环境数据（海拔、流量、氧含量和硝酸盐浓度）沿河流的分布</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#带频度分布的柱状图和光滑拟合曲线的双变量散点图"><span class="nav-number">2.5.3.</span> <span class="nav-text">带频度分布的柱状图和光滑拟合曲线的双变量散点图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pen对数转化前后频度分布柱状图和箱线图"><span class="nav-number">2.5.4.</span> <span class="nav-text">pen对数转化前后频度分布柱状图和箱线图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#环境因子标准化和正态性检验"><span class="nav-number">2.5.5.</span> <span class="nav-text">环境因子标准化和正态性检验</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yunmeng"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Yunmeng</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">41</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ItsYunmeng" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ItsYunmeng" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.bio-info-trainee.com/" title="http:&#x2F;&#x2F;www.bio-info-trainee.com&#x2F;" rel="noopener" target="_blank">生信菜鸟团</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yunmeng</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
