<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Neo Sans Intel:300,300italic,400,400italic,700,700italic|Times New Roman:300,300italic,400,400italic,700,700italic|Lato:300,300italic,400,400italic,700,700italic|Helvetica:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"itsyunmeng.github.io","root":"/","scheme":"Pisces","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Abstract: This document shows the use of R packages (ape, vegan, picante, ggplot2, ggpubr and patchwork) to analyse and visualise feature table and rooted tree files obtained from qiime2. The analysis">
<meta property="og:type" content="article">
<meta property="og:title" content="16S_alpha diversity analysis">
<meta property="og:url" content="https://itsyunmeng.github.io/2020/07/10/16s-alphadiversity/index.html">
<meta property="og:site_name" content="Yunmeng&#39;s Blog">
<meta property="og:description" content="Abstract: This document shows the use of R packages (ape, vegan, picante, ggplot2, ggpubr and patchwork) to analyse and visualise feature table and rooted tree files obtained from qiime2. The analysis">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-07-10T09:34:10.000Z">
<meta property="article:modified_time" content="2020-08-12T14:49:08.925Z">
<meta property="article:author" content="Yunmeng">
<meta property="article:tag" content="16S">
<meta property="article:tag" content="Rplot">
<meta property="article:tag" content="Rstats">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://itsyunmeng.github.io/2020/07/10/16s-alphadiversity/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>16S_alpha diversity analysis | Yunmeng's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Yunmeng's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="https://itsyunmeng.github.io/2020/07/10/16s-alphadiversity/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Yunmeng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yunmeng's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          16S_alpha diversity analysis
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-10 11:34:10" itemprop="dateCreated datePublished" datetime="2020-07-10T11:34:10+02:00">2020-07-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-12 16:49:08" itemprop="dateModified" datetime="2020-08-12T16:49:08+02:00">2020-08-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Omics/" itemprop="url" rel="index"><span itemprop="name">Omics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Omics/Metabarcoding/" itemprop="url" rel="index"><span itemprop="name">Metabarcoding</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>Abstract:</strong> This document shows the use of R packages (ape, vegan, picante, ggplot2, ggpubr and patchwork) to analyse and visualise feature table and rooted tree files obtained from qiime2. The analysis include alpha diversity index (richness, Chao1, ACE, Shannon, Simpson, Pielou, goods_coverage, and PD_whole_tree) and significance test (t test, ANOVA, ANCOVA, wilcox test, TukeyHSD test and kruskal-Wallis test) among different groups. The drawing of barplot and boxplot is also introduced.</p>
<a id="more"></a>
<h1>Data</h1>
<p>total absolute abundance table: <code>feature-table.txt</code><br>
mapping file: <code>mapping.txt</code><br>
rooted tree file: <code>root_tree.nwk</code><br>
The number of samples is less than 50, and the samples are independent.</p>
<h1>Import data</h1>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">otu&lt;-<span class="keyword">read</span>.<span class="keyword">table</span>("feature-table.txt",head=T,<span class="keyword">row</span>.names=<span class="number">1</span>)</span><br><span class="line">otu&lt;-t(otu)</span><br><span class="line">library(ape)</span><br><span class="line">tree&lt;-<span class="keyword">read</span>.tree("root_tree.nwk")</span><br></pre></td></tr></table></figure>
<h1>Alpha diversity index</h1>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">library</span>(vegan)</span><br><span class="line"><span class="title">library</span>(picante)</span><br><span class="line"><span class="title">alpha</span> &lt;- function(x, tree = <span class="type">NULL</span>, base = exp(<span class="number">1</span>)) &#123;</span><br><span class="line">  est &lt;- estimateR(x)</span><br><span class="line">  <span class="type">Richness</span> &lt;- est[<span class="number">1</span>, ]</span><br><span class="line">  <span class="type">Chao1</span> &lt;- est[<span class="number">2</span>, ]</span><br><span class="line">  <span class="type">ACE</span> &lt;- est[<span class="number">4</span>, ]</span><br><span class="line">  <span class="type">Shannon</span> &lt;- diversity(x, index = 'shannon', base = base)</span><br><span class="line">  <span class="type">Simpson</span> &lt;- diversity(x, index = 'simpson')    #<span class="type">Gini</span>-<span class="type">Simpson</span> 指数</span><br><span class="line">  <span class="type">Pielou</span> &lt;- <span class="type">Shannon</span> / log(<span class="type">Richness</span>, base)</span><br><span class="line">  goods_coverage &lt;- <span class="number">1</span> - rowSums(x == <span class="number">1</span>) / rowSums(x)</span><br><span class="line">  result &lt;- <span class="class"><span class="keyword">data</span>.frame(<span class="type">Richness</span>, <span class="type">Shannon</span>, <span class="type">Simpson</span>, <span class="type">Pielou</span>, <span class="type">Chao1</span>, <span class="type">ACE</span>, <span class="title">goods_coverage</span>)</span></span><br><span class="line">  <span class="keyword">if</span> (!is.null(tree)) &#123;</span><br><span class="line">    <span class="type">PD_whole_tree</span> &lt;- pd(x, tree, include.root = <span class="type">FALSE</span>)[<span class="number">1</span>]</span><br><span class="line">    names(<span class="type">PD_whole_tree</span>) &lt;- '<span class="type">PD_whole_tree'</span></span><br><span class="line">    result &lt;- cbind(result, <span class="type">PD_whole_tree</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title">alpha_all</span>&lt;-alpha(otu,tree,base=exp(<span class="number">1</span>))</span><br><span class="line"><span class="title">write</span>.csv(alpha_all, 'alpha_diversity_index.csv', quote = <span class="type">FALSE</span>)</span><br></pre></td></tr></table></figure>
<h1>Merge data</h1>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alpha_all<span class="variable">$sampleID</span>&lt;-rownames(alpha_all)</span><br><span class="line">env&lt;-read.table(<span class="string">"mapping.txt"</span>,<span class="attribute">head</span>=T)</span><br><span class="line">merge_data &lt;- merge(alpha_all,env,<span class="attribute">by</span>=<span class="string">"sampleID"</span>)</span><br></pre></td></tr></table></figure>
<h1>Significance test</h1>
<h2 id="Two-groups">Two groups</h2>
<h3 id="Test-for-normal-distribution">Test for normal distribution</h3>
<h4 id="way1-qqplot">way1: qqplot</h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">library</span><span class="params">(ggplot2)</span></span></span><br><span class="line">Shannon&lt;-merge_data<span class="variable">$Shannon</span></span><br><span class="line">shannon&lt;-as<span class="selector-class">.data</span>.frame(Shannon)</span><br><span class="line"><span class="function"><span class="title">ggplot</span><span class="params">(shannon,aes(sample=Shannon)</span></span>)+geom_qq()+geom_qq_line(distribution=qnorm)</span><br></pre></td></tr></table></figure>
<h4 id="way2-Shapiro-Wilk-test-50-samples">way2: Shapiro-Wilk test (&lt;50 samples)</h4>
<p>If the p-value &gt; 0.05, then the data is normally distributed.</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shapiro.<span class="keyword">test</span>(merge_data<span class="variable">$Shannon</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Test-for-homogeneity-of-variance">Test for homogeneity of variance</h3>
<p>If the p-value &gt; 0.05, then meet the assumption of homogeneity of variance.</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">var</span>.test(<span class="type">Shannon</span>~group1,<span class="class"><span class="keyword">data</span>=merge_data)</span></span><br></pre></td></tr></table></figure>
<h3 id="Significance-test">Significance test</h3>
<h4 id="parametric-test-t-test">parametric test: t test</h4>
<p>If the p-value &lt; 0.05, then a significant difference exists.</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">t</span>.test(<span class="type">Shannon</span>~group1,<span class="class"><span class="keyword">data</span>=merge_data)</span></span><br></pre></td></tr></table></figure>
<h4 id="nonparametric-test-wilcox-test">nonparametric test: wilcox test</h4>
<p>Wicoxon rank sum test (MANN-WHITNEY U TEST)<br>
If the p-value &lt; 0.05, then a significant difference exists.</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wilcox.<span class="keyword">test</span>(Shannon~group1,merge_data)</span><br></pre></td></tr></table></figure>
<h2 id="More-than-two-groups">More than two groups</h2>
<h3 id="Test-for-normal-distribution-2">Test for normal distribution</h3>
<p>see the way in Two groups.</p>
<h3 id="Test-for-homogeneity-of-variance-2">Test for homogeneity of variance</h3>
<p>If the p-value &gt; 0.05, then meet the assumption of homogeneity of variance.</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bartlett.<span class="keyword">test</span>(Shannon~group2,merge_data)</span><br></pre></td></tr></table></figure>
<h3 id="Significance-test-2">Significance test</h3>
<h4 id="parametric-test">parametric test</h4>
<h5 id="ANOVA-TukeyHSD-test">ANOVA &amp; TukeyHSD test</h5>
<p>If ANOVA reports a P value &lt;0.05, you reject the null hypothesis that all the data are sampled with the same mean.</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit&lt;-aov(<span class="name">Shannon</span>~group2,merge_data)</span><br><span class="line">summary(<span class="name">fit</span>)</span><br></pre></td></tr></table></figure>
<p>If the p-value of Tukey HSD test &lt; 0.05, a significant difference exists.</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tuk &lt;- TukeyHSD(<span class="name">fit</span>, conf.level = <span class="number">0.95</span>)</span><br><span class="line">plot(<span class="name">tuk</span>)</span><br><span class="line">tuk</span><br></pre></td></tr></table></figure>
<h5 id="ANCOVA">ANCOVA</h5>
<p><strong>Homogeneity of regression slopes</strong><br>
If p-value &gt;0.05, then meet the assumption of homogeneity of regression slopes.</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summary(<span class="name">aov</span>(<span class="name">Shannon</span>~group2*dist_coast_m,merge_data))</span><br></pre></td></tr></table></figure>
<p><strong>ANCOVA</strong><br>
If the p-value &lt; 0.05, a significant difference exists.</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit&lt;-aov(<span class="name">Shannon</span>~dist_coast_m+group2,merge_data) #write the factor variable in the latter</span><br><span class="line">summary(<span class="name">fit</span>)</span><br></pre></td></tr></table></figure>
<h4 id="nonparametric-test-Kruskal-Wallis-test-Wilcox-test">nonparametric test: Kruskal-Wallis test &amp; Wilcox test</h4>
<p>If the p-value of kruskal-wallis &lt;0.05, you reject the null hypothesis that all the data are sampled with the same mean.<br>
If the p-value of wilcox test &lt; 0.05, a significant difference exists.</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kruskal.test(Shannon~group2,merge_data)</span><br><span class="line">wmc(Shannon~group2,data=merge_data,<span class="function"><span class="keyword">method</span> = "<span class="title">holm</span>")</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>wmc</p>
</blockquote>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nonparametric pairwise multiple comparisons using the Wilcoxon Signed Rank Test</span></span><br><span class="line"><span class="comment"># Probability values are adjusted using the p.adjust function</span></span><br><span class="line">wmc &lt;- function(formula, data, <span class="attribute">exact</span>=<span class="literal">FALSE</span>, <span class="attribute">sort</span>=<span class="literal">TRUE</span>, <span class="attribute">method</span>=<span class="string">"holm"</span>)&#123;</span><br><span class="line"></span><br><span class="line">  # setup</span><br><span class="line">  df &lt;- model.frame(formula, data)</span><br><span class="line">  y &lt;- df[[1]]</span><br><span class="line">  x &lt;- as.factor(df[[2]])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  # reorder levels of x by median y</span><br><span class="line">  <span class="keyword">if</span>(sort)&#123;</span><br><span class="line">    medians &lt;- aggregate(y, <span class="attribute">by</span>=list(x), <span class="attribute">FUN</span>=median)[2]</span><br><span class="line">    index &lt;- order(medians)</span><br><span class="line">    x &lt;- factor(x, levels(x)[index])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  groups &lt;- levels(x)</span><br><span class="line">  k &lt;- length(groups)</span><br><span class="line"></span><br><span class="line">  # summary statistics</span><br><span class="line">  stats &lt;- function(z)(c(N = length(z), Median = median(z), MAD = mad(z)))</span><br><span class="line">  sumstats &lt;- t(aggregate(y, <span class="attribute">by</span>=list(x), <span class="attribute">FUN</span>=stats)[2])</span><br><span class="line">  rownames(sumstats) &lt;- c(<span class="string">"n"</span>, <span class="string">"median"</span>, <span class="string">"mad"</span>)</span><br><span class="line">  colnames(sumstats) &lt;- groups</span><br><span class="line">  cat(<span class="string">"Descriptive Statistics\n\n"</span>)</span><br><span class="line">  <span class="builtin-name">print</span>(sumstats)</span><br><span class="line"></span><br><span class="line">  # multiple comparisons</span><br><span class="line">  mc &lt;- data.frame(Group.<span class="attribute">1</span>=character(0),</span><br><span class="line">                   Group.<span class="attribute">2</span>=character(0),</span><br><span class="line">                   <span class="attribute">W</span>=numeric(0),</span><br><span class="line">                   p.<span class="attribute">unadj</span>=numeric(0),</span><br><span class="line">                   <span class="attribute">p</span>=numeric(0),</span><br><span class="line">                   <span class="attribute">stars</span>=character(0),</span><br><span class="line">                   <span class="attribute">stringsAsFactors</span>=<span class="literal">FALSE</span>)</span><br><span class="line"></span><br><span class="line">  # perform Wilcoxon test</span><br><span class="line">  row &lt;- 0</span><br><span class="line">  <span class="keyword">for</span>(i <span class="keyword">in</span> 1:k)&#123;</span><br><span class="line">    <span class="keyword">for</span>(j <span class="keyword">in</span> 1:k)&#123;</span><br><span class="line">      <span class="keyword">if</span> (j &gt; i)&#123;</span><br><span class="line">        row &lt;- row + 1</span><br><span class="line">        y1 &lt;- y[<span class="attribute">x</span>==groups[i]]</span><br><span class="line">        y2 &lt;- y[<span class="attribute">x</span>==groups[j]]</span><br><span class="line">        test &lt;- wilcox.test(y1, y2, <span class="attribute">exact</span>=exact)</span><br><span class="line">        mc[row,1] &lt;- groups[i]</span><br><span class="line">        mc[row,2] &lt;- groups[j]</span><br><span class="line">        mc[row,3] &lt;- test<span class="variable">$statistic</span></span><br><span class="line">        mc[row,4] &lt;- test<span class="variable">$p</span>.value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  mc<span class="variable">$p</span> &lt;- p.adjust(mc<span class="variable">$p</span>.unadj, <span class="attribute">method</span>=method)</span><br><span class="line"></span><br><span class="line">  # <span class="builtin-name">add</span> stars</span><br><span class="line">  mc<span class="variable">$stars</span> &lt;- <span class="string">" "</span></span><br><span class="line">  mc<span class="variable">$stars</span>[mc<span class="variable">$p</span> &lt;   .1] &lt;- <span class="string">"."</span></span><br><span class="line">  mc<span class="variable">$stars</span>[mc<span class="variable">$p</span> &lt;  .05] &lt;- <span class="string">"*"</span></span><br><span class="line">  mc<span class="variable">$stars</span>[mc<span class="variable">$p</span> &lt;  .01] &lt;- <span class="string">"**"</span></span><br><span class="line">  mc<span class="variable">$stars</span>[mc<span class="variable">$p</span> &lt; .001] &lt;- <span class="string">"***"</span></span><br><span class="line">  names(mc)[6] &lt;- <span class="string">" "</span></span><br><span class="line"></span><br><span class="line">  cat(<span class="string">"\nMultiple Comparisons (Wilcoxon Rank Sum Tests)\n"</span>)</span><br><span class="line">  cat(paste(<span class="string">"Probability Adjustment = "</span>, method, <span class="string">"\n\n"</span>, <span class="attribute">sep</span>=<span class="string">""</span>))</span><br><span class="line">  <span class="builtin-name">print</span>(mc[-4], <span class="attribute">right</span>=<span class="literal">TRUE</span>)</span><br><span class="line">  cat(<span class="string">"---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n"</span>)</span><br><span class="line">  return(invisible(<span class="literal">NULL</span>))</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1>Visualization</h1>
<h2 id="single-index">single index</h2>
<h3 id="barplot">barplot</h3>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Shannon_mean&lt;-aggregate(<span class="name">merge_data</span>$Shannon,by=list(<span class="name">merge_data</span>$group2),FUN=mean)</span><br><span class="line">Shannon_sd&lt;-aggregate(<span class="name">merge_data</span>$Shannon,by=list(<span class="name">merge_data</span>$group2),FUN=sd)</span><br><span class="line">dat &lt;- merge(<span class="name">Shannon_mean</span>, Shannon_sd, by = 'Group.<span class="number">1</span>')</span><br><span class="line">names(<span class="name">dat</span>) &lt;- c('group2', 'mean', 'sd')</span><br><span class="line">dat &lt;- cbind(<span class="name">dat</span>, sign = c('a','a','a','a','a')) #obtained from the above test</span><br><span class="line">library(<span class="name">ggplot2</span>)</span><br><span class="line">ggplot(<span class="name">dat</span>, aes(<span class="name">group2</span>, mean)) +</span><br><span class="line">  geom_col(<span class="name">aes</span>(<span class="name">fill</span> = group2), width = <span class="number">0.4</span>, show.legend = FALSE) +</span><br><span class="line">  geom_errorbar(<span class="name">aes</span>(<span class="name">ymax</span> = mean + sd, ymin = mean - sd), width = <span class="number">0.15</span>, size = <span class="number">0.5</span>) +</span><br><span class="line">  geom_text(<span class="name">aes</span>(<span class="name">label</span> = sign, y = mean +sd + <span class="number">0.5</span>)) +</span><br><span class="line">  theme(<span class="name">panel</span>.grid = element_blank(), panel.background = element_rect(<span class="name">color</span> = 'black', fill = 'transparent'), plot.title = element_text(<span class="name">hjust</span> = <span class="number">0.5</span>)) +</span><br><span class="line">  labs(<span class="name">x</span> = 'Group', y = 'Shannon', title = 'Wilcox test')</span><br></pre></td></tr></table></figure>
<h3 id="boxplot">boxplot</h3>
<h4 id="use-ggplot2">use ggplot2</h4>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ggplot(<span class="name">merge_data</span>)+geom_boxplot(<span class="name">aes</span>(<span class="name">x=group2</span>,y=Shannon))</span><br><span class="line">ggplot(<span class="name">merge_data</span>)+geom_boxplot(<span class="name">aes</span>(<span class="name">x=group2</span>,y=Shannon,fill=group1))</span><br><span class="line">#add significnace</span><br><span class="line">ggplot(<span class="name">merge_data</span>,aes(<span class="name">x=group2</span>,y=Shannon))+geom_boxplot(<span class="name">aes</span>(<span class="name">fill=group2</span>))+stat_compare_means(<span class="name">method=</span><span class="string">"kruskal.test"</span>)</span><br><span class="line">#facet_wrap</span><br><span class="line">ggplot(<span class="name">merge_data</span>)+geom_boxplot(<span class="name">aes</span>(<span class="name">x=group2</span>,y=Shannon,fill=group1))+facet_wrap(~group1,scale=<span class="string">"free"</span>)</span><br><span class="line">#add error bar</span><br><span class="line">ggplot(<span class="name">merge_data</span>,aes(<span class="name">x=group2</span>,y=Shannon))+stat_boxplot(<span class="name">geom=</span><span class="string">"errorbar"</span>,width=0.<span class="number">15</span>)+geom_boxplot(<span class="name">aes</span>(<span class="name">fill=group2</span>))+facet_wrap(~group1,scale=<span class="string">"free"</span>)</span><br><span class="line">#add point</span><br><span class="line">ggplot(<span class="name">merge_data</span>,aes(<span class="name">x=group2</span>,y=Shannon))+stat_boxplot(<span class="name">geom=</span><span class="string">"errorbar"</span>,width=0.<span class="number">15</span>)+geom_boxplot(<span class="name">aes</span>(<span class="name">fill=group2</span>),outlier.color=<span class="string">"red"</span>)+facet_wrap(~group1,scale=<span class="string">"free"</span>)+geom_dotplot(<span class="name">binaxis=</span><span class="string">"y"</span>,stackdir=<span class="string">"center"</span>,position=<span class="string">"jitter"</span>,dotsize=0.<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<h4 id="use-ggpubr">use ggpubr</h4>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="name">ggpubr</span>)</span><br><span class="line">ggboxplot(<span class="name">merge_data</span>,<span class="string">"group2"</span>,<span class="string">"Shannon"</span>,color=<span class="string">"group2"</span>,palette=<span class="string">"jama"</span>,add=<span class="string">"jitter"</span>)+stat_compare_means(<span class="name">method=</span><span class="string">"kruskal.test"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="multiple-indexes">multiple indexes</h2>
<h3 id="barplot-2">barplot</h3>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">merge_data1&lt;-merge_data[,-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">theme &lt;- theme(panel.<span class="attr">background</span> = element_blank(), <span class="comment"># 去掉背景格子</span></span><br><span class="line">               <span class="comment"># 显示x平行网格线</span></span><br><span class="line">               panel.grid.major.<span class="attr">y</span> = element_line(<span class="attr">colour</span> = <span class="string">"black"</span>),</span><br><span class="line">               <span class="comment"># 显示x轴坐标</span></span><br><span class="line">               axis.line.<span class="attr">x</span> = element_line(<span class="attr">colour</span> = <span class="string">"black"</span>),</span><br><span class="line">               axis.line.<span class="attr">y</span> = element_line(<span class="attr">colour</span> = <span class="string">"black"</span>),</span><br><span class="line">               axis.title.<span class="attr">x</span> = element_blank()</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">p &lt;- list()</span><br><span class="line">for (i <span class="keyword">in</span> colnames(merge_data1)[<span class="number">1</span>:<span class="number">8</span>])&#123;</span><br><span class="line">  p[[i]] &lt;- ggplot(<span class="attr">data</span> = merge_data1, aes_string(<span class="attr">x</span> = <span class="string">"group1"</span>,</span><br><span class="line">                                                 <span class="attr">y</span> = i)) +</span><br><span class="line">    geom_col(aes(<span class="attr">fill=group2))</span> +</span><br><span class="line">    theme</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">##devtools::install_github("thomasp85/patchwork")</span></span><br><span class="line">library(patchwork)</span><br><span class="line">multiplot&lt;-wrap_plots(p, <span class="attr">nrow</span> = <span class="number">2</span>) + plot_annotation(<span class="attr">tag_levels</span> = 'a')</span><br><span class="line">multiplot</span><br></pre></td></tr></table></figure>
<h3 id="boxplot-2">boxplot</h3>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">merge_data1&lt;-merge_data[,-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">theme &lt;- theme(panel.<span class="attr">background</span> = element_blank(), <span class="comment"># 去掉背景格子</span></span><br><span class="line">               <span class="comment"># 显示x平行网格线</span></span><br><span class="line">               panel.grid.major.<span class="attr">y</span> = element_line(<span class="attr">colour</span> = <span class="string">"black"</span>),</span><br><span class="line">               <span class="comment"># 显示x轴坐标</span></span><br><span class="line">               axis.line.<span class="attr">x</span> = element_line(<span class="attr">colour</span> = <span class="string">"black"</span>),</span><br><span class="line">               axis.line.<span class="attr">y</span> = element_line(<span class="attr">colour</span> = <span class="string">"black"</span>),</span><br><span class="line">               axis.title.<span class="attr">x</span> = element_blank()</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">p &lt;- list()</span><br><span class="line">for (i <span class="keyword">in</span> colnames(merge_data1)[<span class="number">1</span>:<span class="number">8</span>])&#123;</span><br><span class="line">  p[[i]] &lt;- ggplot(<span class="attr">data</span> = merge_data1, aes_string(<span class="attr">x</span> = <span class="string">"group2"</span>,</span><br><span class="line">                                                  <span class="attr">y</span> = i)) +</span><br><span class="line">    geom_jitter(aes(<span class="attr">color</span> = group1)) +</span><br><span class="line">    geom_boxplot(aes(<span class="attr">fill</span> = sites), <span class="attr">width</span> = .<span class="number">2</span>, <span class="attr">position</span> = position_nudge(<span class="attr">x</span> = - <span class="number">0.01</span>),</span><br><span class="line">                 <span class="attr">fill</span> = <span class="string">"white"</span>, <span class="attr">size</span> = <span class="number">0.8</span>) + stat_compare_means(<span class="attr">method="kruskal.test",cex=2.5)</span></span><br><span class="line">    theme</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">##devtools::install_github("thomasp85/patchwork")</span></span><br><span class="line">library(patchwork)</span><br><span class="line">multiplot&lt;-wrap_plots(p, <span class="attr">nrow</span> = <span class="number">2</span>) + plot_annotation(<span class="attr">tag_levels</span> = 'a')</span><br><span class="line">multiplot</span><br></pre></td></tr></table></figure>
<p>Ref:</p>
<blockquote>
<p>基于OTU的alpha多样性指数计算和可视化：<a href="https://www.jianshu.com/p/343b31082428" target="_blank" rel="noopener">https://www.jianshu.com/p/343b31082428</a><br>
R-t检验：<a href="https://www.jianshu.com/p/fa636135628a" target="_blank" rel="noopener">https://www.jianshu.com/p/fa636135628a</a><br>
R-非参数检验： <a href="https://www.jianshu.com/p/ece7c8848fd9" target="_blank" rel="noopener">https://www.jianshu.com/p/ece7c8848fd9</a><br>
多组间差异分析之方差分析（ANOVA）在R中实现:<a href="http://blog.sciencenet.cn/blog-3406804-1190969.html" target="_blank" rel="noopener">http://blog.sciencenet.cn/blog-3406804-1190969.html</a></p>
</blockquote>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/16S/" rel="tag"># 16S</a>
              <a href="/tags/Rplot/" rel="tag"># Rplot</a>
              <a href="/tags/Rstats/" rel="tag"># Rstats</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/07/03/bioplatform-qiime2/" rel="prev" title="Using QIIME2 to process 16S rRNA metabarcoding illumina Miseq sequencing data">
      <i class="fa fa-chevron-left"></i> Using QIIME2 to process 16S rRNA metabarcoding illumina Miseq sequencing data
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/07/13/16s-alphararefactioncrves/" rel="next" title="16S_alpha rarefaction curves">
      16S_alpha rarefaction curves <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#"><span class="nav-number">1.</span> <span class="nav-text">Data</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#"><span class="nav-number">2.</span> <span class="nav-text">Import data</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#"><span class="nav-number">3.</span> <span class="nav-text">Alpha diversity index</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#"><span class="nav-number">4.</span> <span class="nav-text">Merge data</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#"><span class="nav-number">5.</span> <span class="nav-text">Significance test</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Two-groups"><span class="nav-number">5.1.</span> <span class="nav-text">Two groups</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Test-for-normal-distribution"><span class="nav-number">5.1.1.</span> <span class="nav-text">Test for normal distribution</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#way1-qqplot"><span class="nav-number">5.1.1.1.</span> <span class="nav-text">way1: qqplot</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#way2-Shapiro-Wilk-test-50-samples"><span class="nav-number">5.1.1.2.</span> <span class="nav-text">way2: Shapiro-Wilk test (&lt;50 samples)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Test-for-homogeneity-of-variance"><span class="nav-number">5.1.2.</span> <span class="nav-text">Test for homogeneity of variance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Significance-test"><span class="nav-number">5.1.3.</span> <span class="nav-text">Significance test</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#parametric-test-t-test"><span class="nav-number">5.1.3.1.</span> <span class="nav-text">parametric test: t test</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nonparametric-test-wilcox-test"><span class="nav-number">5.1.3.2.</span> <span class="nav-text">nonparametric test: wilcox test</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#More-than-two-groups"><span class="nav-number">5.2.</span> <span class="nav-text">More than two groups</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Test-for-normal-distribution-2"><span class="nav-number">5.2.1.</span> <span class="nav-text">Test for normal distribution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Test-for-homogeneity-of-variance-2"><span class="nav-number">5.2.2.</span> <span class="nav-text">Test for homogeneity of variance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Significance-test-2"><span class="nav-number">5.2.3.</span> <span class="nav-text">Significance test</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#parametric-test"><span class="nav-number">5.2.3.1.</span> <span class="nav-text">parametric test</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ANOVA-TukeyHSD-test"><span class="nav-number">5.2.3.1.1.</span> <span class="nav-text">ANOVA &amp; TukeyHSD test</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ANCOVA"><span class="nav-number">5.2.3.1.2.</span> <span class="nav-text">ANCOVA</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nonparametric-test-Kruskal-Wallis-test-Wilcox-test"><span class="nav-number">5.2.3.2.</span> <span class="nav-text">nonparametric test: Kruskal-Wallis test &amp; Wilcox test</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#"><span class="nav-number">6.</span> <span class="nav-text">Visualization</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#single-index"><span class="nav-number">6.1.</span> <span class="nav-text">single index</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#barplot"><span class="nav-number">6.1.1.</span> <span class="nav-text">barplot</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#boxplot"><span class="nav-number">6.1.2.</span> <span class="nav-text">boxplot</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#use-ggplot2"><span class="nav-number">6.1.2.1.</span> <span class="nav-text">use ggplot2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#use-ggpubr"><span class="nav-number">6.1.2.2.</span> <span class="nav-text">use ggpubr</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#multiple-indexes"><span class="nav-number">6.2.</span> <span class="nav-text">multiple indexes</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#barplot-2"><span class="nav-number">6.2.1.</span> <span class="nav-text">barplot</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#boxplot-2"><span class="nav-number">6.2.2.</span> <span class="nav-text">boxplot</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yunmeng"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Yunmeng</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">78</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ItsYunmeng" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ItsYunmeng" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/ItsYunmeng" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;ItsYunmeng" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.instagram.com/itsyunmeng" title="Instagram → https:&#x2F;&#x2F;www.instagram.com&#x2F;itsyunmeng" rel="noopener" target="_blank"><i class="fa fa-fw fa-instagram"></i>Instagram</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yunmengli@hotmail.com" title="E-Mail → mailto:yunmengli@hotmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yunmeng</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  













<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

  

</body>
</html>
